var roi = 
    /* color: #0b4a8b */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.MultiPolygon(
        [[[[29.166890555534565, 45.11325251481357],
           [29.166890555534565, 44.71842442391424],
           [29.776631766472065, 44.71842442391424],
           [29.776631766472065, 45.11325251481357]]],
         [[[-92.7370047015699, 18.628059092698177],
           [-92.7370047015699, 18.53531285286924],
           [-92.62439483828865, 18.53531285286924],
           [-92.62439483828865, 18.628059092698177]]],
         [[[-36.65445023526485, -10.249963978999492],
           [-36.65445023526485, -10.647015885790626],
           [-36.23147660245235, -10.647015885790626],
           [-36.23147660245235, -10.249963978999492]]],
         [[[30.281725545395616, 31.522787399455837],
           [30.281725545395616, 31.319461241472286],
           [30.537157674301866, 31.319461241472286],
           [30.537157674301866, 31.522787399455837]]],
         [[[4.7803003228312635, 43.379148055930905],
           [4.7803003228312635, 43.317481473887064],
           [4.895313445389857, 43.317481473887064],
           [4.895313445389857, 43.379148055930905]]],
         [[[106.45902733185157, 20.35088917259552],
           [106.45902733185157, 20.17503601513675],
           [106.6471682009922, 20.17503601513675],
           [106.6471682009922, 20.35088917259552]]],
         [[[0.699515835518163, 40.809633974093856],
           [0.699515835518163, 40.59829561969784],
           [0.934348599190038, 40.59829561969784],
           [0.934348599190038, 40.809633974093856]]],
         [[[12.412622939248843, 45.01451323793262],
           [12.412622939248843, 44.86919212091954],
           [12.57398463358478, 44.86919212091954],
           [12.57398463358478, 45.01451323793262]]],
         [[[82.22035341187735, 16.666683296317274],
           [82.22035341187735, 16.54593917049492],
           [82.36180238648673, 16.54593917049492],
           [82.36180238648673, 16.666683296317274]]],
         [[[82.25949220582267, 16.765327687152144],
           [82.25949220582267, 16.641027411275946],
           [82.38514833375235, 16.641027411275946],
           [82.38514833375235, 16.765327687152144]]],
         [[[81.61376378008663, 16.46292859078407],
           [81.61376378008663, 16.29032630019702],
           [81.83005711504757, 16.29032630019702],
           [81.83005711504757, 16.46292859078407]]],
         [[[-38.99744693853582, -15.756550049841362],
           [-38.99744693853582, -15.94678368326279],
           [-38.803126259824886, -15.94678368326279],
           [-38.803126259824886, -15.756550049841362]]],
         [[[-41.0837211970459, -21.576709155572374],
           [-41.0837211970459, -21.66001327421132],
           [-40.99274066726074, -21.66001327421132],
           [-40.99274066726074, -21.576709155572374]]],
         [[[41.60239861910672, 42.23924165971869],
           [41.60239861910672, 42.152762285102355],
           [41.72427819674344, 42.152762285102355],
           [41.72427819674344, 42.23924165971869]]],
         [[[-75.97466131949656, 9.450877171355085],
           [-75.97466131949656, 9.402953062351541],
           [-75.90942999625436, 9.402953062351541],
           [-75.90942999625436, 9.450877171355085]]],
         [[[0.34871740226035897, 6.169038050135221],
           [0.34871740226035897, 5.663628550349594],
           [1.139733027260359, 5.663628550349594],
           [1.139733027260359, 6.169038050135221]]],
         [[[109.15015234067063, -6.838153268693571],
           [109.15015234067063, -6.856475244369432],
           [109.17126669003586, -6.856475244369432],
           [109.17126669003586, -6.838153268693571]]],
         [[[109.46275254521802, -6.756002170885572],
           [109.46275254521802, -6.8535007830042725],
           [109.57398911748365, -6.8535007830042725],
           [109.57398911748365, -6.756002170885572]]],
         [[[110.14830113410238, -6.828503919445718],
           [110.14830113410238, -6.892586443184825],
           [110.2262353992391, -6.892586443184825],
           [110.2262353992391, -6.828503919445718]]],
         [[[107.60486782070846, -6.176935004804307],
           [107.60486782070846, -6.205093942256697],
           [107.6340502547905, -6.205093942256697],
           [107.6340502547905, -6.176935004804307]]],
         [[[107.67610729214401, -6.218234265243003],
           [107.67610729214401, -6.250486391814471],
           [107.71885097500534, -6.250486391814471],
           [107.71885097500534, -6.218234265243003]]],
         [[[107.62906047671093, -6.2083920836649735],
           [107.62906047671093, -6.231941892146527],
           [107.6573846039082, -6.231941892146527],
           [107.6573846039082, -6.2083920836649735]]],
         [[[-40.07939910570776, -19.374829100284366],
           [-40.07939910570776, -19.75138672980895],
           [-39.67702483812963, -19.75138672980895],
           [-39.67702483812963, -19.374829100284366]]],
         [[[-40.854686959627955, -20.962649814360056],
           [-40.854686959627955, -21.048225366634362],
           [-40.78190253579983, -21.048225366634362],
           [-40.78190253579983, -20.962649814360056]]],
         [[[-98.3393887130798, 26.92963079558997],
           [-98.3393887130798, 24.77947196458621],
           [-96.7848232833923, 24.77947196458621],
           [-96.7848232833923, 26.92963079558997]]],
         [[[-76.5684316766677, 56.5726032422238],
           [-76.5684316766677, 56.5393017822831],
           [-76.516074956697, 56.5393017822831],
           [-76.516074956697, 56.5726032422238]]],
         [[[12.193903754327037, 41.79034318948193],
           [12.193903754327037, 41.705046035478404],
           [12.312006781670787, 41.705046035478404],
           [12.312006781670787, 41.79034318948193]]],
         [[[1.9145608597290487, 41.42264100552855],
           [1.9145608597290487, 41.23753575438766],
           [2.2249246292602987, 41.23753575438766],
           [2.2249246292602987, 41.42264100552855]]],
         [[[-7.4679216788043545, 37.222409172839185],
           [-7.4679216788043545, 37.147464318780685],
           [-7.326816026948886, 37.147464318780685],
           [-7.326816026948886, 37.222409172839185]]],
         [[[-95.37553380406234, 28.988523887224904],
           [-95.37553380406234, 28.89598701473932],
           [-95.24575780308578, 28.89598701473932],
           [-95.24575780308578, 28.988523887224904]]],
         [[[26.804285300148962, 38.602698241845275],
           [26.804285300148962, 38.584115807418975],
           [26.829433691872595, 38.584115807418975],
           [26.829433691872595, 38.602698241845275]]],
         [[[36.05510921898361, -18.677725486567663],
           [36.05510921898361, -18.93252235464484],
           [36.408045009999235, -18.93252235464484],
           [36.408045009999235, -18.677725486567663]]]], null, false);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
 //2. Define the date range
var startDate = '2020-01-01';
var endDate = '2023-12-31';

// 3. Load the Landsat 8 Surface Reflectance collection
var landsatCollection = ee.ImageCollection('LANDSAT/LC08/C02/T1') // Surface Reflectance
  .filterDate(startDate, endDate)  // Filter by time
  .filterBounds(roi)  // Filter by region
  .map(function(image) {  // Remove clouds
    var cloudMask = image.select('QA_PIXEL').bitwiseAnd(1 << 3).eq(0);  // Bit 3 = Cloud Mask
    return image.updateMask(cloudMask);  // Apply cloud mask
  });

// 4. Create a cloud-free composite using median pixel values
var cloudFreeComposite = landsatCollection.median().clip(roi);

// 5. Define visualization parameters (True Color RGB)
var visParams = {
  bands: ['B4','B3','B2'],
  min: 0, 
  max: 3000,  // Adjust for reflectance values
  gamma: 1.4
};

// 6. Display the final cloud-free mosaic
Map.addLayer(cloudFreeComposite, visParams, 'Landsat 8 Cloud-Free Composite');
Map.centerObject(roi, 8);  // Adjust zoom level to fit region
