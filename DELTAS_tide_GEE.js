var roi = 
    /* color: #ff0000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.MultiPolygon(
        [[[[-51.59427202263257, 1.0445619124729515],
           [-51.59427202263257, -0.8120424851480162],
           [-49.07290971794507, -0.8120424851480162],
           [-49.07290971794507, 1.0445619124729515]]],
         [[[94.05578332904402, 16.898570445176652],
           [94.05578332904402, 15.577459465807527],
           [95.85754114154402, 15.577459465807527],
           [95.85754114154402, 16.898570445176652]]],
         [[[39.81716431836997, 64.82313887740557],
           [39.81716431836997, 64.51171869943511],
           [40.71804322461997, 64.51171869943511],
           [40.71804322461997, 64.82313887740557]]],
         [[[158.69227136154328, 69.69795341886883],
           [158.69227136154328, 68.69335370172611],
           [161.88379968185578, 68.69335370172611],
           [161.88379968185578, 69.69795341886883]]],
         [[[117.05136599479502, -0.2722611999907643],
           [117.05136599479502, -0.9451319565232221],
           [117.6926928990919, -0.9451319565232221],
           [117.6926928990919, -0.2722611999907643]]],
         [[[105.73322989583023, 10.488087101034024],
           [105.73322989583023, 9.359918984710871],
           [106.93623282551773, 9.359918984710871],
           [106.93623282551773, 10.488087101034024]]],
         [[[39.21973374702188, -7.7172769719303576],
           [39.21973374702188, -7.913874091536151],
           [39.41714433051797, -7.913874091536151],
           [39.41714433051797, -7.7172769719303576]]],
         [[[142.9441780231981, -8.184128819746418],
           [142.9441780231981, -8.8034778861982],
           [143.86016313061998, -8.8034778861982],
           [143.86016313061998, -8.184128819746418]]],
         [[[67.12032946388983, 24.682292473302283],
           [67.12032946388983, 24.30488241774028],
           [67.59411486428046, 24.30488241774028],
           [67.59411486428046, 24.682292473302283]]],
         [[[67.2288194541242, 24.287359175168966],
           [67.2288194541242, 23.809552465876344],
           [67.81521471779608, 23.809552465876344],
           [67.81521471779608, 24.287359175168966]]],
         [[[67.84661489207288, 24.121298595972306],
           [67.84661489207288, 23.480489641403075],
           [68.80791860301038, 23.480489641403075],
           [68.80791860301038, 24.121298595972306]]],
         [[[88.10388336296825, 22.079953617474555],
           [88.10388336296825, 21.513808258953567],
           [88.70813140984325, 21.513808258953567],
           [88.70813140984325, 22.079953617474555]]],
         [[[88.79052887078075, 22.194438790449617],
           [88.79052887078075, 21.511253010991048],
           [89.6337295543745, 21.511253010991048],
           [89.6337295543745, 22.194438790449617]]],
         [[[89.661195374687, 22.352021089613764],
           [89.661195374687, 21.723185335377607],
           [90.33960113640575, 21.723185335377607],
           [90.33960113640575, 22.352021089613764]]],
         [[[90.37256012078075, 22.509425378682977],
           [90.37256012078075, 21.812461045139234],
           [91.2157608043745, 21.812461045139234],
           [91.2157608043745, 22.509425378682977]]],
         [[[-114.87733865007239, 31.844724942984243],
           [-114.87733865007239, 31.623977266479304],
           [-114.54980874284583, 31.623977266479304],
           [-114.54980874284583, 31.844724942984243]]],
         [[[144.2752990992516, -7.361442514979171],
           [144.2752990992516, -7.8950065196003765],
           [144.8905334742516, -7.8950065196003765],
           [144.8905334742516, -7.361442514979171]]],
         [[[143.69534242146497, -7.541186065602016],
           [143.69534242146497, -8.055487489923165],
           [144.22817933552747, -8.055487489923165],
           [144.22817933552747, -7.541186065602016]]],
         [[[47.86857668477945, 30.099876792943608],
           [47.86857668477945, 29.52555705443528],
           [48.5579687746232, 29.52555705443528],
           [48.5579687746232, 30.099876792943608]]],
         [[[48.7227636964982, 30.514836798934777],
           [48.7227636964982, 30.002404105137362],
           [49.39018313009195, 30.002404105137362],
           [49.39018313009195, 30.514836798934777]]],
         [[[121.07124576277728, 32.01789221589598],
           [121.07124576277728, 31.161614356083774],
           [122.05726871199603, 31.161614356083774],
           [122.05726871199603, 32.01789221589598]]],
         [[[-144.99426695547777, 60.54200575207851],
           [-144.99426695547777, 60.41749990305588],
           [-144.76218077383714, 60.41749990305588],
           [-144.76218077383714, 60.54200575207851]]],
         [[[-145.6986440505344, 60.50767538460847],
           [-145.6986440505344, 60.441351710428165],
           [-145.55788172143284, 60.441351710428165],
           [-145.55788172143284, 60.50767538460847]]],
         [[[-145.52011621850315, 60.44372274778779],
           [-145.52011621850315, 60.356558302913726],
           [-145.33472193139377, 60.356558302913726],
           [-145.33472193139377, 60.44372274778779]]],
         [[[-145.29117898888225, 60.381301851779575],
           [-145.29117898888225, 60.292608974318604],
           [-145.08655862755413, 60.292608974318604],
           [-145.08655862755413, 60.381301851779575]]],
         [[[-123.30498821086806, 49.13566286558342],
           [-123.30498821086806, 48.9989021606811],
           [-123.03719646282119, 48.9989021606811],
           [-123.03719646282119, 49.13566286558342]]],
         [[[-42.30031524013971, -2.6862809790741258],
           [-42.30031524013971, -2.841282311448903],
           [-42.156119683499085, -2.841282311448903],
           [-42.156119683499085, -2.6862809790741258]]],
         [[[-42.14856658291315, -2.682851519407441],
           [-42.14856658291315, -2.835110082346677],
           [-41.96591887783502, -2.835110082346677],
           [-41.96591887783502, -2.682851519407441]]],
         [[[-16.79077118175016, 14.041148356816393],
           [-16.79077118175016, 13.87922185017812],
           [-16.57928436534391, 13.87922185017812],
           [-16.57928436534391, 14.041148356816393]]],
         [[[-16.77387243195517, 13.891406779235426],
           [-16.77387243195517, 13.736712763197174],
           [-16.569252070627044, 13.736712763197174],
           [-16.569252070627044, 13.891406779235426]]],
         [[[-16.644981902405288, 13.784451563663191],
           [-16.644981902405288, 13.630354097824618],
           [-16.49563650445607, 13.630354097824618],
           [-16.49563650445607, 13.784451563663191]]],
         [[[-16.592991504526687, 13.664079817486533],
           [-16.592991504526687, 13.55096037597117],
           [-16.47076860413606, 13.55096037597117],
           [-16.47076860413606, 13.664079817486533]]],
         [[[125.9852317782805, 37.9220000665738],
           [125.9852317782805, 37.40235376527294],
           [126.71719588960862, 37.40235376527294],
           [126.71719588960862, 37.9220000665738]]],
         [[[126.36149090844924, 37.39801558357174],
           [126.36149090844924, 36.85273596836651],
           [127.05912274438674, 36.85273596836651],
           [127.05912274438674, 37.39801558357174]]],
         [[[125.53807174462244, 38.04281956344608],
           [125.53807174462244, 37.67200104504177],
           [126.04893600243494, 37.67200104504177],
           [126.04893600243494, 38.04281956344608]]],
         [[[5.886868221598567, 4.676638438200886],
           [5.886868221598567, 4.191950081700747],
           [6.460903866129817, 4.191950081700747],
           [6.460903866129817, 4.676638438200886]]],
         [[[6.452664120036067, 4.6328380670128295],
           [6.452664120036067, 4.2576889251524515],
           [6.826199276286067, 4.2576889251524515],
           [6.826199276286067, 4.6328380670128295]]],
         [[[6.724575741129817, 4.832654824869137],
           [6.724575741129817, 4.28233954849691],
           [7.391995174723567, 4.28233954849691],
           [7.391995174723567, 4.832654824869137]]],
         [[[-74.88489129371324, 11.12320020762296],
           [-74.88489129371324, 10.944602937793046],
           [-74.6631047946898, 10.944602937793046],
           [-74.6631047946898, 11.12320020762296]]],
         [[[-61.31007745183078, 9.247781545185394],
           [-61.31007745183078, 8.422735685076693],
           [-60.51356866276828, 8.422735685076693],
           [-60.51356866276828, 9.247781545185394]]],
         [[[-58.71796530207988, 7.188375864323658],
           [-58.71796530207988, 6.653970657151786],
           [-58.18238180598613, 6.653970657151786],
           [-58.18238180598613, 7.188375864323658]]],
         [[[3.5613080020922583, 51.954746920594296],
           [3.5613080020922583, 51.445776995488956],
           [4.503385638811008, 51.445776995488956],
           [4.503385638811008, 51.954746920594296]]],
         [[[147.5260934680048, -19.636459995336782],
           [147.5260934680048, -19.734730213569218],
           [147.62050722532902, -19.734730213569218],
           [147.62050722532902, -19.636459995336782]]]], null, false);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
 //2. Define the date range
var startDate = '2020-01-01';
var endDate = '2023-12-31';

// 3. Load the Landsat 8 Surface Reflectance collection
var landsatCollection = ee.ImageCollection('LANDSAT/LC08/C02/T1') // Surface Reflectance
  .filterDate(startDate, endDate)  // Filter by time
  .filterBounds(roi)  // Filter by region
  .map(function(image) {  // Remove clouds
    var cloudMask = image.select('QA_PIXEL').bitwiseAnd(1 << 3).eq(0);  // Bit 3 = Cloud Mask
    return image.updateMask(cloudMask);  // Apply cloud mask
  });

// 4. Create a cloud-free composite using median pixel values
var cloudFreeComposite = landsatCollection.median().clip(roi);

// 5. Define visualization parameters (True Color RGB)
var visParams = {
  bands: ['B4','B3','B2'],
  min: 0, 
  max: 3000,  // Adjust for reflectance values
  gamma: 1.4
};

// 6. Display the final cloud-free mosaic
Map.addLayer(cloudFreeComposite, visParams, 'Landsat 8 Cloud-Free Composite');
Map.centerObject(roi, 8);  // Adjust zoom level to fit region
